!function(){function e(e,t){var e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");return t&&(e=e.replace(/"/g,"&quot;")),e}function t(e){var t=document.createElement("a");return t.href=e,""==t.host&&(t.href=t.href),t}function n(e){var t={};return e.split("&").forEach(function(e){if(e){var n=e.split("="),i=n[0].trim();i&&(t[i]=(n[1]||"").trim())}}),t}function i(e,t){var n=null;window.XMLHttpRequest?n=new XMLHttpRequest:window.ActiveXObject&&(n=new ActiveXObject("Microsoft.XMLHTTP")),n&&(n.onreadystatechange=function(){4==n.readyState&&(200==n.status?t(null,n.responseText):t(new Error("XMLHttpRequest failed")),n=null)},n.open("GET",e,!0),n.send(null))}function o(e,t,n){var i=null;if(window.XMLHttpRequest?i=new XMLHttpRequest:window.ActiveXObject&&(i=new ActiveXObject("Microsoft.XMLHTTP")),i){var o=JSON.stringify(t);i.onreadystatechange=function(){4==i.readyState&&(200==i.status?n(null,i.responseText):n(new Error("XMLHttpRequest failed")),i=null)},i.open("POST",e,!0),i.setRequestHeader("Content-Type","application/json; charset=utf-8"),i.send(o)}}function r(e,t){if(!e.types)return!1;var n,i=e.types.length;for(n=0;n<i;n+=1)if(e.types[n]==t)return!0;return!1}function a(e){e.stopPropagation()}function l(e){e.stopPropagation(),e.preventDefault()}function s(){return _e&&"none"!=_e.style.display}function d(e){var t;if(e&&(t=lt(e))){var n=e.getAttribute("data-rewgt-owner");return n?n+"."+t:t}return""}function p(e){var t=e.split("/");if(t.length<=2)return null;for(var n,i=t.shift(),o="";n=t.shift();){if("$"!=n[0]||"$"!=n[1]){o+="/"+n;break}o+="/"+n}var r=t.join("/");return r?[i,o,r]:null}function u(e,t){var n=Array.isArray(e)?e:p(e+"");if(n){var o=n[0]+n[1];if(!ot.hasOwnProperty(o)){var r,a=o+"/"+n[2];i(r=rt.isGithub?n[1]+"/TOOL.json":"/app/"+o+"/web/TOOL.json",function(e,n){if(e)console.log("error: read file failed ("+r+")");else try{var i=JSON.parse(n);ot[o]=!1;var l={},s=[];Object.keys(i).forEach(function(e){var t=i[e];t&&Array.isArray(t.tools)&&(t.hasOwnProperty("baseUrl")?(t.tools.forEach(function(e){e.baseUrl=t.baseUrl}),l[e]=t):(t.name=e,s.push(t)))}),s.forEach(function(e){var n=e.opt||"mono/all",i=[],o=!1;if(e.tools.forEach(function(e){if("string"==typeof e)if("*"!=e){var t=e.split("/"),n=t.pop(),r=t.join("/"),a=n&&l[r];if(a&&Array.isArray(a.tools)){var s=a.tools.find(function(e){return e.name===n});s&&i.push(s)}}else o=!0}),ot[e.name]=[n,i,o],a==e.name&&t){var r=n.split("/");t[0]=r[0],t[1]=r[1]||"all"}})}catch(e){console.log(e),ce.instantShow("error: parse JSON failed ("+r+").")}})}}}function c(e){for(var t=Qe.length-1;t>=0;t-=1)if(Qe[t][0]===e){Qe.splice(t,1);break}}function f(){var e="";if(Re&&Re.parentNode){var t=U(Re);t&&(e=t[0])}return{viewportX:de,viewportY:pe,viewportWd:ue,topPanelHi:ce.frameInfo.topHi,rightPanelWd:ce.frameInfo.rightWd,rootKeyid:Ke,showPages:"none"!=ke.style.display,selected:e}}function h(){if(!et)return[];try{var e=localStorage.getItem("rewgt/design-bakIndex")||"[]";return JSON.parse(e)}catch(e){return[]}}function g(){for(var e,t=h(),n=[];e=t[1];)n.push(e[0]),t.splice(1,1);if(n.length)try{n.forEach(function(e){localStorage.removeItem("rewgt/design-bak_"+e)}),localStorage.setItem("rewgt/design-bakIndex",JSON.stringify(t))}catch(e){}}function v(e,t){var n=t.length,i=Math.min(64,Math.max(3,parseInt(Je.cacheSize)||5)),o=1048576*(i-=1);if(n>o)ce.instantShow("error: write backup failed (document size should less than "+i+"M).");else{var r=h(),a=-1;it&&((a=r.findIndex(function(e){return e[0]==it}))>=0&&a<r.length-1?a+=1:a=-1);var l=0;r.forEach(function(e,t){(a<0||t<a)&&(l+=e[1])}),l+=n;for(var s=[];l>o&&r.length;){d=r.shift();s.push(d[0]),l-=d[1]}a-=s.length;try{if(a>=0)for(var d=r[a];d;)s.push(d[0]),r.splice(a,1),d=r[a];r.push([e,n]),s.forEach(function(e){localStorage.removeItem("rewgt/design-bak_"+e)}),localStorage.setItem("rewgt/design-bak_"+e,t),localStorage.setItem("rewgt/design-bakIndex",JSON.stringify(r)),it=0}catch(e){ce.instantShow("error: save backup to local storage failed."),console.log("write local storage failed, it's size should large than 5M.")}}}function m(e){try{return localStorage.getItem("rewgt/design-bak_"+e)}catch(e){return null}}function y(){if(!st&&ce.dumpTree){var e=[];if(ce.dumpTree(e),1==e.length){st=!0;var t=(new Date).valueOf()-1e3;v(t,JSON.stringify({id:t,state:f(),doc:e[0]}))}}}function b(e){function t(){nt=setTimeout(function(){if(nt=0,n+=1,Qe.length)if(n>=4){var i=Qe[0][1];ce.instantShow("hint: can not save backup when system not in idle"+(i?" (still in "+i+")":"")+".")}else e=1e3,t();else{var o=[];if(ce.dumpTree(o),1==o.length){var r=(new Date).valueOf();v(r,JSON.stringify({id:r,state:f(),doc:o[0]}))}}},e)}if(et&&ce.dumpTree){nt&&(clearTimeout(nt),nt=0);var n=0;"number"!=typeof e&&(e=3e3),t()}}function x(e){if(!et)return!1;if(Qe.length){var t=Qe[0][1];return ce.instantShow("warning: task ("+e+") ignored when system not in idle"+(t?" (still in "+t+").":".")),!1}return!nt||(ce.instantShow("warning: task ("+e+") ignored when pending backup not finished."),!1)}function w(){if(x("undo")){var e=-1,t=h();it?(e=t.findIndex(function(e){return e[0]==it}))>=0&&(e-=1):e=t.length-2;var n=e>=0?t[e][0]:0;if(!n||n<tt)ce.instantShow("warning: nothing to undo.");else{var i=m(n);if(!i)return void ce.instantShow("warning: load backup item from local storage failed.");A(i),it=n}}}function k(){if(x("redo")){var e=-1,t=h();if(it&&((e=t.findIndex(function(e){return e[0]==it}))>=0&&e+1<t.length?e+=1:e=-1),e<0)ce.instantShow("warning: nothing to redo.");else{var n=t[e][0],i=m(n);if(!i)return void ce.instantShow("warning: load backup item from local storage failed.");A(i),it=n}}}function A(e){function t(){K(),de=o.viewportX||0,pe=o.viewportY||0,ue=o.viewportWd||0,ce.frameInfo.topHi=o.topPanelHi||0,ce.frameInfo.rightWd=o.rightPanelWd||0,ce.style.left=de+"px",ce.style.top=pe+"px",fe.style.backgroundPosition=ie-14+"px "+(ce.frameInfo.topHi+pe)+"px",he.style.backgroundPosition=ie+de+"px "+(te-28)+"px",he.style.display=ce.frameInfo.topHi?"block":"none",ge.style.display=ce.frameInfo.rightWd?"block":"none",ye.style.display=0==de&&0==pe?"block":"none",O(),o.showPages?(be.style.visibility="visible",ke.style.display="block"):(ke.style.display="none",be.style.visibility="hidden"),ke.innerHTML="",ke.style.left="0px",o.rootKeyid?P(o.rootKeyid,!1,n):(he.listChildren(""),n())}function n(){var e=o.selected;e?ce.getWidgetNode&&ce.getWidgetNode(e,"",function(e){J(e,!1,!1)}):he.listChildren("")}if(ce.loadTree){var i=JSON.parse(e),o=i.state,r=i.doc;Re=null,ce.loadTree(ce,r,function(){ce.topmostNode()?t():alert("Restore backup version failed!")})}}function E(e,t){"ScenePage"==Fe&&C(Ke),t&&setTimeout(function(){_(t)},100),b(e)}function S(e,t){var n=t.cloneNode(!0);n.style.display="block",n.style.position="static",n.style.width="900px",n.style.height="700px",n.style.transform="scale(0.142)",n.style.transformOrigin="0 0",n.style.zIndex="3006",e.appendChild(n);var i,o=t.querySelectorAll("canvas"),r=o.length;r&&r==(i=n.querySelectorAll("canvas")).length&&setTimeout(function(){for(var e,t,n=0;e=o[n];n++)(t=i[n]).width&&t.height&&t.getContext("2d").drawImage(e,0,0)},600)}function M(e,t){var n=!1;if(t)n=!0;else{for(var i,o=0;i=e[o];o++){var r=i[0]+"",a=ke.children[o];if(!a||a.getAttribute("keyid")!==r){n=!0;break}}n||e.length==ke.children.length||(n=!0)}if(n){ke.innerHTML="";var l=xe.clientWidth||window.innerWidth-ie-80,s=Math.floor(l/re);ke.style.width=Math.max((e.length+s-1)*re,20)+"px",e.forEach(function(e){var t=e[0]+"",n=e[1],i=n.getAttribute("name"),o=document.createElement("div");o.setAttribute("style","width:128px; height:100px; background:#fff; margin:2px 4px; float:left; overflow:hidden; outline:red dotted 0px"),o.setAttribute("keyid",t),i&&o.setAttribute("name",i),ke.appendChild(o),S(o,n)})}for(var d,o=0;d=ke.children[o];o++){var p=d.getAttribute("keyid")==Ke;d.style.outlineWidth=p?"1px":"0px"}}function P(e,t,n){ce.showRootPage?ce.showRootPage(e,function(i){he.listChildren(""),Ke=(Fe=i)?e:"";for(var o,r="ScenePage"==i?e:"",a=0;o=ke.children[a];a++){var l=o.getAttribute("keyid")==r;o.style.outlineWidth=l?"1px":"0px"}!t||"Panel"!=i&&"Template"!=i||ce.getWidgetNode(ce.frameInfo.rootName+"."+e,"",function(e){J(e,!1,!1)}),r&&ce.getWidgetNode(ce.frameInfo.rootName+"."+e,"",function(t){t&&setTimeout(function(){var n=document.createEvent("Event");n.initEvent("slideenter",!0,!0),n.pageKey=e,t.dispatchEvent(n)},0)}),n&&n()}):n&&n()}function C(e){if(e){var t=null,n=[];ce.listChildren&&(t=ce.listChildren("")),t&&(n=t[4]);for(var i,o=null,r=0;i=n[r];r+=1)if(i[0]==e){o=i[1];break}if(o)for(var a,r=0;a=ke.children[r];r++)if(a.getAttribute("keyid")==e){sName=o.getAttribute("name"),sName?a.setAttribute("name",sName):a.removeAttribute("name"),a.innerHTML="",S(a,o);break}}}function L(){var e=0==ce.frameInfo.topHi;ae=Math.floor(.5*(ue||window.innerWidth-ie-(e?0:ne))),le=Math.floor(.5*(window.innerHeight-(e?0:te)-pe))}function T(){var e=0==ce.frameInfo.topHi;ve.style.top=(e?0:te)+(le-10)+pe+"px",me.style.left=ie+(ae-10)+de+"px",ye.style.left=ue?ie+ue-20+de+"px":window.innerWidth-ne-20+"px"}function N(e,t){function n(e){var t=[],n={};return Object.keys(e).forEach(function(n){var i,o=e[n];if("object"==o.type)if("default"in o)i=o.default;else{if(!("properties"in o))return;i={};var r=o.properties;Object.keys(r).forEach(function(e){i[e]=r[e].default})}else i=o.default;t.push([o.propertyOrder||0,n,i])}),t.sort(function(e,t){return e[0]-t[0]}),t.forEach(function(e){n[e[1]]=e[2]}),n}var i=null,o=null,r=null;return[function(a){var l=a.props&&ce.widgetSchema(a,!1,t);return l&&2==l.length?(i=l[0],o=l[1],r=o.wdgtOption,delete o.wdgtOption,[n(o.properties||{}),e,r]):[null,e,null]},function(t,n,a){function l(t,n){var i=e;if(s&&(Re=p),t){if(n)if(n.classList.contains("rewgt-scene")){var o=d(n);F(),o&&setTimeout(function(){P(o,!1,function(){J(n,!1,!1)})},0)}else{var r=U(n),a=r?r[0]:"";a&&a==e?J(n,!1,!1):i=""}E(300,i)}}var s=!1,p=Re;if(o&&r&&i&&n[0]){var u=n[1],c=n[2];if(ce.saveWdgtProp&&"object"==typeof u&&Array.isArray(c))return s=!0,Re=null,c.forEach(function(e){u[e]=void 0}),void ce.saveWdgtProp(t,i,r,u,l)}return l(!1,null)}]}function I(e){for(var t,n=Te.querySelectorAll("img"),i=null,o=0;t=n[o];o++)t.getAttribute("extend")?Te.removeChild(t):(t.style.display="none",e&&"uplevel"==t.getAttribute("name")&&(i=t));i?(Te.style.width=oe+"px",Te.style.visibility="visible",i.style.display="inline"):(Te.style.width="0px",Te.style.visibility="hidden")}function D(e,t,n,i){for(var o,r=Te.querySelectorAll("img"),a=[],l=[],d=0;o=r[d];d++)if(o.getAttribute("extend"))Te.removeChild(o);else{var p=o.getAttribute("name");p&&e[p]?a.push(o):l.push(o)}var u=[];t&&t.forEach(function(e){if(e.clickable&&(!e.onlyScene||i)){var t,o=e.icon,r=e.baseUrl||"";t=o?"/"==o[0]||0==o.indexOf("http")&&(":"==o[4]||"s:"==o.slice(4,6))?o:r&&"/"!=r.slice(-1)?r+"/"+o:r+o:rt.appBase()+"/res/tools.png";var a=document.createElement("img");a.setAttribute("extend","true"),a.setAttribute("style","display:none; width:16px; height:16px; border:1px solid #f0f0f0; margin:2px;"),a.setAttribute("src",t),e.title&&a.setAttribute("title",e.title),a.setAttribute("draggable","false"),Te.appendChild(a),u.push(a),a.onload=function(e){e.target.style.display="inline"},a.onclick=function(t){if(!s()&&(t.stopPropagation(),Re&&Re.parentNode&&ce.popDesigner)){var i=U(Re);if(i){var o=i[0],a=Object.assign({},e);if(!a.get||!a.set){var l=N(o,n);a.get=l[0],a.set=l[1]}ce.popDesigner(o,a.name,a,r)}}}}}),l.forEach(function(e){e.style.display="none"}),Te.style.width=oe*(a.length+u.length)+2+"px",a.forEach(function(e){e.style.display="inline"})}function O(e){var t,n=window.innerWidth,i=window.innerHeight;if(!(n<ie+80+ne)){t=ue?Math.max(ne,n-(ie+ue+de)):ne,L(),ce.frameInfo.rightWd=0==ce.frameInfo.topHi?0:t,ce.frameInfo.bottomHi=pe,ce.refreshFrame&&ce.refreshFrame();var o=he.querySelectorAll("td")[2];o&&(o.style.width=t+"px"),ge.style.left=n-t+"px",ge.style.width=t+"px",Ee.style.height=i-64+"px";var r=n-ie-t;be.style.width=r+"px",xe.style.width=r-80+"px",we.style.width=r-80+"px",T(),ze.style.width=(ze.isFull?n-ie:n-ie-ce.frameInfo.rightWd)+"px"}}function H(e,t){function n(){Me.inScene=a,Me.style.borderColor=o?a?"transparent blue blue blue":"transparent red red red":a?"blue":"red",Me.style.left=Pe.left+"px",Me.style.top=Pe.top+"px",Me.style.width=Math.max(0,Pe.width-2)+"px",Me.style.height=Math.max(0,Pe.height-2)+"px",Me.style.display="block"}function i(){Ce.style.borderColor=r?"transparent blue blue blue":"blue",Ce.style.left=Le.left+"px",Ce.style.top=Le.top+"px",Ce.style.width=Math.max(0,Le.width-2)+"px",Ce.style.height=Math.max(0,Le.height-2)+"px",Ce.style.display="block"}var o=!1,r=!1,a=!1;if(e){var l,s,d,p;try{l=e.getBoundingClientRect()}catch(e){l=null}if(!l)return;(d=Math.min(0,l.top-ce.frameInfo.topHi))<0&&(o=!0,l={left:l.left,top:ce.frameInfo.topHi,width:l.width,height:l.height+d});var u=!1;if(ht.length){var c=ht[ht.length-1][2];try{s=c.getBoundingClientRect(),u=!0}catch(e){}u&&(p=Math.min(0,s.top-ce.frameInfo.topHi))<0&&(r=!0,s={left:s.left,top:ce.frameInfo.topHi,width:s.width,height:s.height+p})}var f=!1;u?f=Le.left!=s.left||Le.top!=s.top||Le.width!=s.width||Le.height!=s.height:(Ce.style.display="none",Le={left:0,top:0,width:0,height:0});var h=(new Date).valueOf();(u&&Re!==e||f)&&(ut&&(clearTimeout(ut),ut=0),Le=s,Re!==e&&(ct=0),h-ct>2e3?i():(Ce.style.display="none",ut=setTimeout(i,800)),ct=h);var g=!1,v=Pe.left!=l.left||Pe.top!=l.top||Pe.width!=l.width||Pe.height!=l.height;(Re!==e||v)&&(dt&&(clearTimeout(dt),dt=0),Pe=l,Re!==e&&(pt=0,Re=e,je+=1,g=!0),t?(a=3==t.length&&"ScenePage"==t[1][0],Me.isSceneWdgt=a):a=Me.isSceneWdgt,h-pt>2e3?n():(Me.style.display="none",dt=setTimeout(n,800)),pt=h,g&&j(t)),!g&&t&&setTimeout(function(){Ge.select()},0)}else Re&&(Ce.style.display="none",Me.style.display="none",Re=null,Ie.innerHTML="",j(null))}function _(e){if(Re&&Re.parentNode&&ce.widgetSchema){var t=U(Re);if(t){var n=t[0],i=t[2],o=B(i);if((!e||n==e)&&o<2){var r=0!=o||B(i,!0)>0;(t=ce.widgetSchema(n,!0,r))&&Ee.setPropEditor(t[0],t[1],t[2],t[3])}}}}function B(e,t){var n=0,i=e.length-2;for(t&&(i+=1);i>=0;){var o=e[i];if(i-=1,o[3])return 2;var r=o[0];if("Template"==r||"ScenePage"==r){for(;i>=0;){var a=e[i];if(i-=1,a[3]){n=2;break}}return n}var l,s=o[2];if(s&&(l=s[1]))if("some"==l)n=1;else if("none"==l)return 2;if(t)break}return n}function z(e,t){var n=ce.getGroupOpt(t);return n&&n.tools&&(e=e.slice(0),n.tools.forEach(function(t){(t=Object.assign({},t)).baseUrl=n.baseUrl,e.push(t)})),e}function R(e){return!(e.children.length>0&&"edit"!==e.getAttribute("data-html.opt"))}function j(e){function t(){for(var e=!!ce.hideTemplate;item=ht.pop();)e&&ce.hideTemplate(item[1],!0)}if(ce.setSceneCurrent){var n=[],i=!1;if(ft.length)if(!e||e.length<=2||"ScenePage"!=e[1][0])n.push([ft[0],""]),ft=[],i=!0;else{ft[0]!=e[1][1]&&(i=!0,n.push([ft[0],""]));var o=e[1][1],r=e[2][1];ft[0]==o&&ft[1]==r||(i=!0),ft=[o,r],n.push(ft)}else e&&e.length>2&&"ScenePage"==e[1][0]&&(ft=[e[1][1],e[2][1]],i=!0,n.push(ft));n.length&&ce.setSceneCurrent(n),i&&setTimeout(function(){"ScenePage"==Fe&&C(Ke)},300)}if(!Re)return t(),gt=[],Ee.setPropEditor(0,null,null),qe=!1,void(Ue=!1);if(e){t(),gt=[];var a=3==e.length&&"ScenePage"==e[1][0],l=!!ce.showTemplate,s=e.length-1,d="",p=!1,u=!1;e.forEach(function(e,t){d&&(d+="."),d+=e[1];var n=e[0],i=e[2],o=e[3];o&&(gt.push(o),t==s&&(p=!0)),"Template"==n&&i&&(ht.push(i),l&&ce.showTemplate(i[1],!0),t==s&&(u=!0))}),G(d);var c=null,f=B(e),h=0,g=!1,v=!1,m=Re.getAttribute("data-group.optid");if(m){var y=ot[m];y?("all"!=(y[0]||"mono/all").split("/").pop()&&(v=!0),c=y[1],g=y[2]):h=500}else f>=2&&(h=500);setTimeout(function(){var t=!1;if(h&&m&&(i=ot[m])&&("all"!=(i[0]||"mono/all").split("/").pop()&&(v=!0,t=!0),c=i[1],g=i[2]),h&&f>=2&&(f=B(e)),f>=2)I(!0),Ee.setPropEditor(0,null,null);else{var n=!1;if(d&&ce.widgetSchema){t||(v=0!=f||B(e,!0)>0);var i=ce.widgetSchema(d,!0,v);i&&(n=i[4]&&R(Re),Ee.setPropEditor(i[0],i[1],i[2],i[3]))}var o=e.length>=2?e[1][0]:"",r={copy:1};if(1!=f&&(r.move=1),p&&(r.linker=1,r.styles=1),n&&(r.edit_txt=1),(e.length>2||2==e.length&&("Panel"==o||"ScenePage"==o))&&(r.uplevel=1),a&&(r.copy_lnk=1,r.up=1,r.down=1),d&&ce.getGroupOpt)if(g&&c)c=z(c,d);else if(!c){var l=ce.getGroupOpt(d),s=l&&l.tools||[];c=[],s.forEach(function(e){(e=Object.assign({},e)).baseUrl=l.baseUrl,c.push(e)}),v=l&&"all"!=l.editable}D(r,c,v,a)}},h)}qe=!!Re.style.width,Ue=!!Re.style.height}function q(e){for(var t,n=0;t=e[n];n++)if(t[3]&&n<e.length-1)return!0;return!1}function U(e,t){var n=ce.children[0];if(!n)return null;for(var i=[],o=[],r=!1,a=null,l="";e;){if(e===n){r=!0,t&&t.unshift(e),i.unshift(["Panel",ce.frameInfo.rootName,["mono","all"]]),l=ce.frameInfo.rootName+l,o.forEach(function(e){e[1]=ce.frameInfo.rootName+e[1]});break}var s=d(e);if(s){var p=[],c=!1;if(e.classList.contains("rewgt-panel")?p.push("Panel"):e.classList.contains("rewgt-unit")?p.push("Unit"):e.classList.contains("rewgt-inline")&&(p.push("Span"),c=!0),p.length){a||(a=e);var f=c?"data-span.path":"data-unit.path";if(e.hasAttribute(f)||(f=""),p.push(s),e.hasAttribute("data-temp.type")){h=[e.getAttribute("data-temp.type"),"",e];o.push(h),p.push(h),p[0]="Template"}else if(e.classList.contains("rewgt-scene")){var h=[e.getAttribute("name")||"","",e];o.push(h),p.push(h),p[0]="ScenePage"}else{var g=e.getAttribute("data-group.opt")||"",v=g.split("/"),m=["mono","none"],y=e.getAttribute("data-group.optid");y?(h=ot[y])?(v=(g=h[0]+"").split("/"),m[0]=v[0]||"mono",m[1]=v[1]||"all"):u(y,m):(m[0]=v[0]||"mono",m[1]=v[1]||"all"),p.push(m)}if(f){var b=[e.getAttribute(f),"",e];o.push(b),p.push(b)}t&&t.unshift(e),i.unshift(p),l="."+s+l,o.forEach(function(e){e[1]="."+s+e[1]})}}e=e.parentNode}return r&&a?[l,a,i]:null}function X(){if("0px"!=Te.style.width){var e=mt+=1;Te.style.visibility="visible",vt=setTimeout(function(){e==mt&&(Te.style.visibility="hidden",vt=0)},4e3)}}function J(e,t,n){if(!e)return null;var i=U(e);if(i&&i.length>=2){if(t&&2==i.length&&"Panel"!=i[1][0])return i;var o=i[0],r=i[1],a=i[2];H(r,a),he.setWidgetInfo(a),he.listChildren(o),n&&X()}return i}function F(){De.style.display="none",H(null,null),he.setWidgetInfo(null),he.listChildren(""),$e=0,Ge.value=""}function K(){Re=null,Fe="",Ke="",ft=[],ht=[],gt=[],bt=!1,yt=0,xt=!1,Tt=!1,Dt=!1,Ot=!1,qe=!1,Ue=!1,Ye=null,Ve=0,De.style.display="none",Ce.style.display="none",Me.style.display="none",ce.style.zIndex="3000",He.style.display="none",_e.style.display="none",Be.style.display="none",Ie.innerHTML="",We.innerHTML="",We.isSceneWdgt=!1}function G(e){Array.isArray(e)&&(Ye=null),ce.dumpWidget&&setTimeout(function(){$e=1,ce.dumpWidget(e,function(t,n){t&&(Ve=je,Ye=e,$e=2,Ge.value=n,Ge.select())})},0)}function $(e){if(bt=!1,yt=0,!s()){var t=e.target;if("IMG"!=t.nodeName||"DIV"!=(t=t.parentNode).nodeName||"float-btn"!==t.getAttribute("name")){var n=e.clientX,i=e.clientY;if(function(e,t){if(e>ie){if(ce&&0==ce.frameInfo.topHi)return!0;if(t>te)return!0}return!1}(n,i)){var o=document.body.style.cursor;if(Re&&o&&("ew-resize"==o?yt=1:"ns-resize"==o?yt=2:"nwse-resize"==o&&(yt=3)),Lt=!1,Wt=!1,Ht=!1,wt=!1,bt=!1,yt)Pt=n,Ct=i;else if(!e.shiftKey&&"ScenePage"==Fe){var r=!1,a=!1;if(!Re||Re.classList.contains("rewgt-scene")||Re.getAttribute("data-is.ground")&&(a=!0)){if(a?Lt=!0:"block"==De.style.display&&De.children.length>1?!function(e,t){for(var n,i=1;n=De.children[i];i+=1){var o=n.getBoundingClientRect();if(e>=o.left&&e<o.left+o.width&&t>=o.top&&t<o.top+o.height)return!0}return!1}(n,i)?Lt=!0:(Wt=!0,multiWdgtMoved_=!1,Bt=n,zt=i):Lt=!0,Lt)for(Nt=n,It=i;De.children.length>1;)De.removeChild(De.children[1]);document.body.style.cursor="default"}else{var l=Re.getBoundingClientRect();if(n>=l.left&&n<l.left+l.width&&i>=l.top&&i<l.top+l.height)r=!0,wt=!0,Mt=!1,At=n,Et=i;else{for(Lt=!0,Nt=n,It=i;De.children.length>1;)De.removeChild(De.children[1]);document.body.style.cursor="default"}}r||e.preventDefault()}}}}}function Y(e,t,n){for(var i=[e],o=1;r=De.children[o];o+=1)(a=r.getAttribute("keyid"))&&i.push(a);if(!(i.length<=1)&&ce.moveSceneWdgt){y(),i=ce.moveSceneWdgt(i,t,n);for(var r,o=1;r=De.children[o];o+=1){var a=r.getAttribute("keyid");a&&i.indexOf(a)>=0&&(t&&(r.style.left=parseFloat(r.style.left)+t+"px"),n&&(r.style.top=parseFloat(r.style.top)+n+"px"))}E(3e3,"")}}function V(e){if(!(s()||ce.splitterMouseDn&&ce.splitterMouseDn())){var t="default",n=e.clientX,i=e.clientY;if(Lt){if(ce.selectMultWdgt){for(;De.children.length>1;)De.removeChild(De.children[1]);var o=Math.min(n,Nt),r=Math.min(i,It),a=Math.max(n,Nt),l=Math.max(i,It),d=De.children[0];d?d.style.display="block":((d=document.createElement("div")).setAttribute("style","position:absolute; border:1px dotted red; left:0px; top:0px; width:0px; height:0px;"),De.appendChild(d)),d.style.left=o+"px",d.style.top=r+"px",d.style.width=Math.max(0,a-o-2)+"px",d.style.height=Math.max(0,l-r-2)+"px",(c=ce.selectMultWdgt(Ke,Nt,It,n,i)).forEach(function(e){var t=e[0],n=e[1],i=e[2],o=e[3],r=e[4],a=document.createElement("div");a.setAttribute("keyid",t),a.setAttribute("style","position:absolute; border:1px dotted red; left:"+n+"px; top:"+i+"px; width:"+Math.max(0,o-2)+"px; height:"+Math.max(0,r-2)+"px;"),De.appendChild(a)}),De.style.display="block",je+=1}}else if(Wt&&(Ht||(Math.abs(n-Bt)>=4||Math.abs(i-zt)>=4)&&(Wt=!1,Ht=!0,_t=Ze+=1,Qe.push([_t,"moving widget"]))),Ht){h=i-zt;0==(f=n-Bt)&&0==h||(multiWdgtMoved_||(multiWdgtMoved_=!0,y()),Bt=n,zt=i,Y(Ke,f,h))}else if(Re&&Re.parentNode){var p=Re.getBoundingClientRect(),u=Math.min(0,p.top-ce.frameInfo.topHi);if(u<0&&(p={left:p.left,top:ce.frameInfo.topHi,width:p.width,height:p.height+u}),n>=p.left&&n<p.left+p.width&&i>=p.top&&i<p.top+p.height&&(vt&&(clearTimeout(vt),vt=0),bt||"none"!=De.style.display||X(),n>=p.left+p.width-6?i>=p.top+p.height-6?qe?t=Ue?"nwse-resize":"ew-resize":Ue&&(t="ns-resize"):qe&&(t="ew-resize"):i>=p.top+p.height-6&&Ue&&(t="ns-resize"),Me.inScene&&!bt&&wt&&"default"==t&&"none"!=Me.style.display&&ce.splitterMouseDn&&!ce.splitterMouseDn()&&(Math.abs(n-At)>=4||Math.abs(i-Et)>=4))){var c=U(Re);c&&(Te.style.visibility="hidden",St=c[0],Mt=!1,bt=!0,wt=!1,kt=Ze+=1,Qe.push([kt,"moving widget"]))}if(bt){yt=0,document.body.style.cursor="default";var f=n-At,h=i-Et;(f||h)&&(At=n,Et=i,Mt||(Mt=!0,y()),ce.moveSceneWdgt(St,f,h),f&&(Me.style.left=parseInt(Me.style.left)+f+"px"),h&&(Me.style.top=parseInt(Me.style.top)+h+"px"))}else document.body.style.cursor=t}else document.body.style.cursor=t}}function Z(e){if(!s())if(ce.splitterMouseDn&&ce.splitterMouseDn()){Tt=!1,Lt=!1,De&&(De.style.display="none",De.children.length&&(De.children[0].style.display="none")),Te.style.visibility="hidden",Wt=!1,Ht=!1,Dt=!1,multiWdgtMoved_=!1,wt=!1,Ot=!1,bt=!1,Mt=!1,yt=0;var t=Qe.length;t&&Qe.splice(0,t)}else{if(Tt=!1,De)if(De.children.length<=1)De.style.display="none";else{if(Lt&&(Tt=!0,setTimeout(function(){Tt=!1},1e3),"ScenePage"==Fe&&Ke)){for(var n,i=[Ke],o=1;n=De.children[o];o+=1){var r=n.getAttribute("keyid");r&&i.push(r)}if(i.length>1)if(2==i.length&&ce.getWidgetNode){var a=ce.frameInfo.rootName+"."+Ke+"."+i[1];setTimeout(function(){ce.getWidgetNode(a,"",function(e){e&&(De.style.display="none",J(e,!1,!1))})},300)}else H(null,null),G(i)}De.children[0].style.display="none",Te.style.visibility="hidden"}else;if(Lt=!1,Wt=!1,Dt=!1,Ht&&(Ht=!1,c(_t),multiWdgtMoved_&&(Dt=!0,setTimeout(function(){Dt=!1},1e3),multiWdgtMoved_=!1,E(3e3,""))),wt=!1,Ot=!1,bt)bt=!1,c(kt),Mt&&St&&(Ot=!0,setTimeout(function(){Ot=!1},1e3),Mt=!1,E(3e3,St));else if(Re&&yt){xt=!0,setTimeout(function(){xt=!1},1e3);var l=e.clientX-Pt,d=e.clientY-Ct,p=!1;if(1!=yt&&3!=yt||0==l||(p=!0),2!=yt&&3!=yt||0==d||(p=!0),p&&ce.resizeWidget){var u=U(Re);if(u&&!q(u[2])){var f=u[0];y(),ce.resizeWidget(f,yt,l,d,function(e){e&&E(3e3,f)})}}}yt=0,setTimeout(function(){var e=Qe.length;e&&Qe.splice(0,e)},0)}}function Q(){function f(e,t,n,i,o,r,a){if(ce.copyWidget){var l=Re,s=!1;l&&l.parentNode&&(Re=null,s=!0),y(),ce.copyWidget(e,t,n,i,o,r,function(e,t){if(e){var n="";if(t)if(t.classList.contains("rewgt-scene")){var i=d(t);F(),i&&setTimeout(function(){P(i,!1,function(){var e=U(t);e&&(n=e[0]),J(t,!1,!1)})},0)}else if(t.parentNode.parentNode===ce&&"absolute"==t.style.position)F();else if(s){var o=U(t);o&&(n=o[0]),J(t,!1,!1)}E(600,n)}else s&&(Re=l);a&&a(e)})}}function h(e,t,n,o,r,a){function l(){var n=s.widget,i=s.name||"";if(Array.isArray(n)){"/"==i[0]&&(i=i.slice(1));var l=p(i);l?u(l,null):i="",y(),e&&(n=s.scene||n),ce.createWidget(n,i,t,o,r,a,function(e,t){e&&(t&&t.classList.contains("rewgt-scene")?(F(),"visible"!=be.style.visibility&&ce.instantShow("create ScenePage successful.")):t&&t.parentNode.parentNode===ce&&t.getAttribute("data-temp.type")?F():J(t,!0,!1),E(300,""))})}}if(ce.createWidget){var s=n.option;if("object"!=typeof s){if(void 0===s&&n.dragUrl){var d=n.dragUrl+".json";i(d,function(e,t){if(e)ce.instantShow("error: read JSON failed ("+d+")."),console.log(e);else{try{s=JSON.parse(t)}catch(e){console.log(e),ce.instantShow("error: parse JSON failed ("+d+").")}s&&s.name&&l()}})}}else s.name&&l()}}function v(e){if(r(e.dataTransfer,"application/json"))e.preventDefault();else{if(!I)return;I!==Ne&&I.parentNode!==Te||e.preventDefault()}}function m(e){e.stopPropagation(),e.preventDefault();var t=We.textContent;if(t){var n=!!e.shiftKey||e.target===lt,i=20-de-ae,o=20-pe-le;if(r(e.dataTransfer,"application/json")){var a=null,l=e.dataTransfer.getData("application/json")||"{}";try{a=JSON.parse(l)}catch(e){console.log(e)}if(!a||"template"!=a.dragType&&"image"!=a.dragType)return;var s=!1;if("ScenePage"==Fe&&Ke){var d=t.split(".");(3==d.length||!n&&4==d.length)&&(s=!0)}if("image"==a.dragType){var p=a.dragUrl,u=a.clientWidth,c=a.clientHeight;if(!p)return;0==p.indexOf(se)&&p.length>se.length&&(p=p.slice(se.length));var g={src:p},v=["Img",g,3];u&&c&&(g.style={width:u+"px",height:c+"px"}),s&&(v=[["P",{klass:"default-large-small hidden-visible-auto","data-group.optid":"rewgt/shadow-slide/steps"},2],v]),h(s,t,{option:{name:"Img",widget:v}},n,i,o)}else h(s,t,a,n,i,o),Ne.style.display="none"}else if(I){var m=e.dataTransfer.getData("text/plain"),b=I.getAttribute("name");m&&t&&b&&("linker"==b&&ce.bindLinker?(y(),ce.bindLinker(m,t,function(e){e&&(Ne.style.display="none",E(300,""))})):"copy"!=b&&"move"!=b||f(m,t,n,"move"==b,i,o,function(e){e&&(Ne.style.display="none")}))}}}function b(){if(Re){var e=Re.parentNode;e&&(Re.classList.contains("rewgt-scene")?ce.resetRootShow?ce.resetRootShow(function(){Fe="",Ke="",F()}):F():J(e,!1,!1)||Re.classList.contains("rewgt-panel")&&"absolute"!=Re.style.position&&F())}}function x(e){var t=null;if("ScenePage"==Fe&&Ke&&"block"==De.style.display&&De.children.length>1){for(var n,i=[Ke],o=1;n=De.children[o];o+=1){var r=n.getAttribute("keyid");r&&i.push(r)}i.length>1&&(t=i)}else{if(!Re||!Re.parentNode)return;var a=U(Re);if(a){if(B(a[2])>=1)return void ce.instantShow("remove selected widget disallowed.");t=a[0]}}t&&function(e,t,n){if(ce.removeWidget&&(!n||confirm("do you want delete selected widget?"))){var i="";if("ScenePage"==Fe&&t&&t.classList.contains("rewgt-scene"))for(var o,r=!1,a=0;o=ke.children[a];a++){var l=o.getAttribute("keyid");if(l)if(l==Ke)r=!0;else if(i=l,r)break}y(),ce.removeWidget(e,function(e){e&&(F(),i&&setTimeout(function(){P(i,!1)},300),E(300,""))})}}(t,Re,e)}function A(e){function t(e,t){e?(ce.instantShow("error: save document failed"+(t?" ("+t+").":".")),console.log(e)):ce.instantShow("save document successful.")}if(e.stopPropagation(),Oe.hideMenu(),ce.getDocHtml){var n=ce.getDocHtml(rt.useHtmlProxy);if(n)if(rt.useHtmlProxy)rt.savePages(n,t);else{var i={page:Xe,html:n};o("$save?page="+encodeURIComponent(Xe),i,t)}else ce.instantShow("warning: dump document failed.")}}var S=0,I=null,W=null,D=null,_=null;if("/"!=(se=document.location.href.split("?")[0]).slice(-1)&&(se=se.slice(0,se.lastIndexOf("/")+1)),Xe=n(window.location.search.slice(1)).page||"index.html",ce=document.getElementById("react-container")){ce.frameInfo?(Object.assign(ce.frameInfo,{topHi:te,rightWd:ne,bottomHi:0,leftWd:ie}),setTimeout(function(){ce.refreshFrame&&ce.refreshFrame()},1e3)):ce.frameInfo={topHi:te,rightWd:ne,bottomHi:0,leftWd:ie,rootName:".body"},ce.classList.add("noselect-txt");var j=ce.getAttribute("__design__");if(j&&"0"!=j){ce.version=function(){return ee},ce.instantShow=function(t){if(t&&_){for(console.log("[MSG]",t);_.children.length>=5;){var n=_.children[0];_.removeChild(n)}var i=window.innerWidth,o=(window.innerHeight,0);i>800?(o=.2*i,i*=.6):i>400&&(o=.1*i,i*=.8),_.style.left=o+"px",_.style.width=i+"px";var r=document.createElement("p");r.setAttribute("style","width:"+(i-14)+"px; margin:2px; padding:6px; border:1px solid #ccc; background-color:#ffe; line-height:1.4; font-size:14px; color:#222; text-align:center; overflow:hidden; border-radius:3px; transition: all 0.4s ease-out; -o-transition: all 0.4s ease-out; -moz-transition: all 0.4s ease-out; -webkit-transition: all 0.4s ease-out; -ms-transition: all 0.4s ease-out;"),r.innerHTML=e(t),_.appendChild(r),_.style.display="block",setTimeout(function(){r&&r.parentNode&&(r.style.borderWidth="0px",r.style.margin="0px",r.style.padding="0px",r.style.height="0px")},1e4)}},L(),window.onbeforeunload=function(){return"This is single page application, do you want shift to another page?"},(he=document.createElement("div")).setAttribute("style","position:absolute; left:0px; top:0px; width:100%; height:"+te+"px; background:#e8e8e8 url("+rt.appBase()+"/res/ruler_top.png) no-repeat fixed "+(ie+de)+"px "+(te-28)+"px; z-index:3006;"),document.body.appendChild(he),(fe=document.createElement("div")).setAttribute("style","position:absolute; left:0px; top:0px; width:"+ie+"px; height:100%; background:#e8e8e8 url("+rt.appBase()+"/res/ruler_left.png) no-repeat fixed "+(ie-14)+"px "+(te+pe)+"px; z-index:3020;"),(ge=document.createElement("div")).setAttribute("style","position:absolute; right:0px; top:0px; width:"+ne+"px; height:100%; background-color:#e8e8e8; z-index:3020; overflow:hidden;"),document.body.appendChild(ge);var q=document.createElement("div");q.setAttribute("style","position:relative; left:3px; top:3px; line-height:1.2; width:100%; height:"+te+"px;"),fe.appendChild(q),(Ht=[["Main menu",rt.appBase()+"/res/menu.png","menu"],["Show pages/widgets",rt.appBase()+"/res/grid.png","thumb"]]).forEach(function(e){var t=e[0],n=e[1],i=e[2],o=document.createElement("img");o.setAttribute("style","width:22px; height:22px; border:1px solid #e8e8e8;"),o.setAttribute("src",n),o.setAttribute("title",t),o.setAttribute("name",i),q.appendChild(o)}),fe.addEventListener("mouseover",function(e){var t=e.target;"IMG"==t.nodeName&&(t.style.borderColor="#f8f8f8 #aaa #aaa #f8f8f8")},!1),fe.addEventListener("mouseout",function(e){var t=e.target;"IMG"==t.nodeName&&(t.style.borderColor="#e8e8e8")},!1);var X=document.createElement("div");X.setAttribute("style","position:relative; left:3px; top:0px; line-height:1.2; width:100%;"),fe.appendChild(X),(Ht=[["Switch viewport",rt.appBase()+"/res/switch.png","switch"],["Align center",rt.appBase()+"/res/align.png","align"],["","",""],["Remove widget",rt.appBase()+"/res/delete.png","delete"],["Undo",rt.appBase()+"/res/undo.png","undo"],["Redo",rt.appBase()+"/res/redo.png","redo"],["","",""],["Save",rt.appBase()+"/res/save.png","save"],["Open or create page",rt.appBase()+"/res/open.png","open"],["Config",rt.appBase()+"/res/config.png","config"]]).forEach(function(e){var t=e[0],n=e[1],i=e[2];if(n){var o="width:22px; height:22px; border:1px solid #e8e8e8;";!rt.useHtmlProxy||"open"!=i&&"config"!=i||(o+="display:none");var r=document.createElement("img");r.setAttribute("style",o),r.setAttribute("src",n),r.setAttribute("title",t),r.setAttribute("name",i),X.appendChild(r)}else{var a=document.createElement("div");a.setAttribute("style","width:100%; height:20px;"),X.appendChild(a)}}),ve=document.createElement("div");var K=te+(le-10)+pe;ve.setAttribute("style","position:absolute; left:"+(ie-10)+"px; top:"+K+"px; width:9px; height:18px; border:1px solid #aaa; background-color:rgba(192,192,192,0.7); cursor:ns-resize;"),ve.setAttribute("title","Drag to move y-axis"),fe.appendChild(ve);var Q=0,Pe=!1,Le=!1,qe=0;ve.addEventListener("click",a,!1),ve.addEventListener("mousedown",function(e){e.stopPropagation(),e.preventDefault(),Pe=!0,Le=!1,Q=e.clientY},!1),document.addEventListener("mousemove",function(e){var t=e.clientY;if(!(t<=20||t>=window.innerHeight-20)&&(!Le&&Pe&&Math.abs(t-Q)>=4&&(qe=Ze+=1,Qe.push([qe,"moving viewport"]),F(),Le=!0,Pe=!1),Le)){e.stopPropagation(),e.preventDefault();var n=t-Q;0!=n&&(Q=t,pe+=n,ce.style.top=pe+"px",ve.style.top=te+(le-10)+pe+"px",fe.style.backgroundPosition=ie-14+"px "+((0==ce.frameInfo.topHi?0:te)+pe)+"px")}},!1),document.addEventListener("mouseup",function(e){Pe=!1,Le&&(c(qe),Le=!1,e.stopPropagation(),e.preventDefault(),pe+=e.clientY-Q,L(),ce.style.top=pe+"px",ve.style.top=te+(le-10)+pe+"px",fe.style.backgroundPosition=ie-14+"px "+((0==ce.frameInfo.topHi?0:te)+pe)+"px",ce.frameInfo.bottomHi=pe,ce.refreshFrame&&ce.refreshFrame())},!1),he.innerHTML='<table style="width:100%; height:100%; border-collapse:collapse; margin:0px; padding:0px; border:0px solid gray; table-layout:auto; overflow:hidden"><tr><td style="width:'+ie+'px"></td><td style="vertical-align:top"></td><td style="width:'+ne+'px"></td></tr></table>';var Ue=he.querySelectorAll("td")[1],tt=document.createElement("div");tt.setAttribute("style","width:100%; height:60px; margin:3px 0px 2px 0px; line-height:1.2; background-color:#f4f4f4; overflow-y:auto; border-radius:3px;"),Ue.appendChild(tt);var nt=document.createElement("div");nt.setAttribute("style","width:100%; height:28px; overflow:hidden; font-size:15px; line-height:18px;"),Ue.appendChild(nt);var it=document.createElement("div");it.setAttribute("style","width:100%; height:20px;"),it.setAttribute("title","Click to unselect widget"),Ue.appendChild(it),(Ne=document.createElement("img")).setAttribute("draggable","true"),Ne.setAttribute("style","display:none; width:16px; height:16px; border:1px solid #e8e8e8; margin:0px 6px 0px 0px;"),Ne.setAttribute("src",rt.appBase()+"/res/empty.png"),nt.appendChild(Ne),(Ie=document.createElement("span")).setAttribute("style","padding:2px 8px 2px 0px; color:#444;"),nt.appendChild(Ie),(We=document.createElement("span")).setAttribute("style","padding:2px 10px 2px 0px; color:#444;"),nt.appendChild(We);var lt=document.createElement("img");lt.setAttribute("style","display:none; position:relative; top:-1px; width:16px; height:16px;"),lt.setAttribute("src",rt.appBase()+"/res/insert.png"),nt.appendChild(lt),be=document.createElement("div");var st=window.innerWidth-ie-ne;be.setAttribute("style","visibility:hidden; position:absolute; left:"+ie+"px; top:0px; width:"+st+"px; height:"+(te-10)+"px; background-color:#e8e8e8; overflow:hidden;"),he.appendChild(be),be.innerHTML='<div name="prev_page" title="previous page" style="position:absolute; left:1px; top:2px; width:20px; height:102px; background:#ccc"></div><div name="prev_item" title="previous item" style="position:absolute; left:21px; top:2px; width:20px; height:102px; background:#ddd"></div><div name="page_div" style="position:absolute; left:40px; top:0px; width:'+(st-80)+'px; height:104px; z-index:3006; overflow:hidden"><div name="page_list" style="display:none; position:relative; left:0px, top:0px; width:20px; height:100%; overflow:hidden"></div></div><div name="page_mask" style="position:absolute; left:40px; top:0px; width:'+(st-80)+'px; height:104px; z-index:3006; overflow:hidden"></div><div name="page_tip" style="display:none; position:absolute; z-index:3040; background-color:#ffd; border:1px solid #ddd; font-size:12px; color:#222; line-height:1; padding:4px; box-shadow:0 3px 3px rgba(0,0,0,0.2)"></div><div name="next_item" title="next item" style="position:absolute; right:20px; top:2px; width:20px; height:102px; background:#ddd"></div><div name="next_page" title="next page" style="position:absolute; right:0px; top:2px; width:20px; height:102px; background:#ccc"></div>',xe=be.querySelector('div[name="page_div"]'),we=be.querySelector('div[name="page_mask"]'),ke=be.querySelector('div[name="page_list"]');var dt=be.querySelector('div[name="page_tip"]');we.addEventListener("mousedown",l,!1),we.addEventListener("dragstart",l,!1),we.addEventListener("dragend",l,!1),we.addEventListener("dragover",function(e){if(I&&I.parentNode===Te){var t=I.getAttribute("name");"copy"!=t&&"move"!=t||e.preventDefault()}},!1),we.addEventListener("drop",function(e){if(e.stopPropagation(),e.preventDefault(),I){var t=e.dataTransfer.getData("text/plain");if(t&&ce.getWidgetNode){var n=I.getAttribute("name");if("copy"==n||"move"==n){var i=Math.floor(Math.max(0,0-ke.offsetLeft)/re),o=we.getBoundingClientRect(),r=Math.max(0,e.clientX-o.left),a=i+Math.floor(r/re),l=ke.children[a],s=null,d="",p=l?l.getAttribute("keyid")||"":"";a>0&&(s=ke.children[a-1])&&(d=s.getAttribute("keyid")||""),ce.getWidgetNode(t,"",function(e){if(e&&e.classList.contains("rewgt-scene")){var t=U(e);if(t){var i=t[0],o=i.split("."),r=o.pop();if("move"==n&&(r==p||r==d))return;var a=!0,l=ce.frameInfo.rootName;p&&(a=!1,o.push(p),l=o.join(".")),f(i,l,a,"move"==n,0,0)}}})}}}},!1);var pt=0,ut=!1;we.addEventListener("click",function(t){t.stopPropagation(),t.preventDefault(),Oe.hideMenu();var n=Math.floor(Math.max(0,0-ke.offsetLeft)/re),i=we.getBoundingClientRect(),o=Math.max(0,t.clientX-i.left),r=t.clientY,a=n+Math.floor(o/re),l=ke.children[a];if(l){var s=l.getAttribute("keyid")||"",d=l.getAttribute("name");(s=d?s+": "+d:s)&&(pt&&(clearTimeout(pt),pt=0,dt.style.display="none"),setTimeout(function(){ut||(dt.style.left=o+40+2+"px",dt.style.top=Math.min(te-36,r+20)+"px",dt.innerHTML=e(s),dt.style.display="block",pt=setTimeout(function(){dt.style.display="none",pt=0},3e3))},500))}},!1),we.addEventListener("dblclick",function(e){e.stopPropagation(),e.preventDefault(),ut=!0,setTimeout(function(){ut=!1},1e3);var t=Math.floor(Math.max(0,0-ke.offsetLeft)/re),n=we.getBoundingClientRect(),i=Math.max(0,e.clientX-n.left),o=t+Math.floor(i/re),r=ke.children[o];if(r){var a=r.getAttribute("keyid");a&&(F(),setTimeout(function(){P(a,!1),r.querySelector("canvas")&&setTimeout(function(){C(a)},600)},0))}},!1);for(var ct,ft=0;ct=be.children[ft];ft++)0!=(ct.getAttribute("name")||"").indexOf("page_")&&(ct.addEventListener("mouseover",function(e){var t=e.target;"DIV"==t.nodeName&&(t.style.opacity="0.7")},!1),ct.addEventListener("mouseout",function(e){var t=e.target;"DIV"==t.nodeName&&(t.style.opacity="1")},!1),ct.addEventListener("click",function(e){e.stopPropagation();var t=Math.floor(xe.clientWidth/re);if(!(t<=0)){var n=Math.max(0,0-ke.offsetLeft),i=Math.floor(n/re),o=ke.children.length,r=e.target.getAttribute("name");"prev_page"==r?i>=t?ke.style.left=0-n+t*re+"px":i>0&&(ke.style.left="0px"):"next_page"==r?o>i+t&&(ke.style.left=0-n-t*re+"px"):"prev_item"==r?i>0&&(ke.style.left=0-re*(i-1)+"px"):"next_item"==r&&i+1<o&&(ke.style.left=0-re*(i+1)+"px")}},!1));Ne.addEventListener("mouseover",function(e){var t=e.target;"IMG"==t.nodeName&&(t.style.borderColor="#f8f8f8 #aaa #aaa #f8f8f8")},!1),Ne.addEventListener("mouseout",function(e){var t=e.target;"IMG"==t.nodeName&&(t.style.borderColor="#e8e8e8")},!1),Ne.addEventListener("click",a,!1),Ne.addEventListener("dblclick",function(e){e.stopPropagation(),Ne.style.display="none"},!1),Ne.addEventListener("dragstart",function(e){var t=Ne.getAttribute("title");t&&(S=Ze+=1,Qe.push([S,"dragging widget"]),I=Ne,e.dataTransfer.setData("text/plain",t))},!1),Ne.addEventListener("dragend",function(e){I&&c(S),I=null,W.selectedInfo=null,W.style.display="none"},!1),Ie.addEventListener("click",a,!1),We.addEventListener("click",function(e){e.stopPropagation();var t=e.target;if("SPAN"==t.nodeName){var n=t.getAttribute("title"),i=t.getAttribute("path");n&&i&&ce.getWidgetNode&&ce.getWidgetNode(n,i,function(e){J(e,!1,!1)})}},!1),Ie.addEventListener("mousedown",a,!1),Ie.addEventListener("mousemove",a,!1),Ie.addEventListener("mouseup",a,!1),We.addEventListener("mousedown",a,!1),We.addEventListener("mousemove",a,!1),We.addEventListener("mouseup",a,!1);var ht=0;nt.addEventListener("dragover",function(e){ht&&clearTimeout(ht);var t=I&&"linker"==I.getAttribute("name");ht=setTimeout(function(){We.style.backgroundColor="",lt.style.display="none",ht=0},1e3),We.style.backgroundColor="#f8f8f8",lt.style.display=t?"none":"inline"},!1),We.addEventListener("dragover",v,!1),We.addEventListener("drop",m,!1),lt.addEventListener("dragover",v,!1),lt.addEventListener("drop",m,!1),he.setWidgetInfo=function(t){var n="";t&&t.forEach(function(t,i){var o=t[0],r=t[1],a=t[2],l=t[3];if(i>0&&(r="."+r),"Template"==o&&a)n+='<span style="color:blue">'+e(r)+"</span>";else if(l){var s=l[0],d=l[1];n+=s&&d?'<span title="'+e(s,!0)+'" path="'+e(d,!0)+'" style="color:blue; text-decoration:underline">'+e(r)+"</span>":e(r)}else n+=e(r)}),We.innerHTML=n,We.isSceneWdgt=t&&3==t.length&&"ScenePage"==t[1][0]};var gt=!0;he.listChildren=function(t){var n="",i=["","#c00",-1,[],[]];ce.listChildren&&(i=ce.listChildren(t));var o=i[0],r=i[1],a=i[2],l=i[3],s=i[4];l.forEach(function(t,i){n+=i==a?'<button style="color:'+r+'">':"<button>",n+=e(t)+"</button>"}),tt.innerHTML=n,o=t?o.replace(/</g,"").replace(/>/g,""):"",Ie.setAttribute("wdgt_name",o),Ie.innerHTML=o?"<b>"+e(o)+"</b>:":"",t||gt||M(s,!1)},tt.addEventListener("click",function(e){var t=e.target;if("BUTTON"==t.nodeName){e.stopPropagation(),Oe.hideMenu();var n=t.textContent;if(n)if(Re){if(ce.getWidgetNode){var i=U(Re);if(i){var o=i[0],r=i[2];ce.getWidgetNode(n,o,function(e,t){if(e)if(t){var i=2==r.length&&"ScenePage"==r[1][0];Ne.setAttribute("src",rt.appBase()+"/res/linker.png"),Ne.setAttribute("name","linker"),Ne.setAttribute("title",o+"."+n),Ne.isSceneWdgt=i,Ne.style.display="inline"}else J(e,!1,!0)})}}}else P(n,!0)}},!1),me=document.createElement("div");var vt=ie+(ae-10)+de;me.setAttribute("style","position:absolute; left:"+vt+"px; top:"+(te-10)+"px; width:18px; height:9px; border:1px solid #aaa; background-color:rgba(192,192,192,0.7); cursor:ew-resize;"),me.setAttribute("title","Drag to move x-axis"),he.appendChild(me);var mt=0,wt=!1,kt=!1,At=0;me.addEventListener("click",a,!1),me.addEventListener("mousedown",function(e){e.stopPropagation(),e.preventDefault(),wt=!0,kt=!1,mt=e.clientX},!1),document.addEventListener("mousemove",function(e){var t=e.clientX;if(!(t<=ie+20||t>=window.innerWidth-ne-30)&&(!kt&&wt&&Math.abs(t-mt)>=4&&(At=Ze+=1,Qe.push([At,"moving viewport"]),F(),kt=!0,wt=!1),kt)){e.stopPropagation(),e.preventDefault();var n=t-mt;0!=n&&(mt=t,de+=n,ce.style.left=de+"px",he.style.backgroundPosition=ie+de+"px "+(te-28)+"px",T())}},!1),document.addEventListener("mouseup",function(e){if(wt=!1,kt){c(At),kt=!1,e.stopPropagation(),e.preventDefault();var t=e.clientX;if(t<=ie+20||t>=window.innerWidth-ne-30)return;var n=t-mt;0!=n&&(de+=n,ce.style.left=de+"px",he.style.backgroundPosition=ie+de+"px "+(te-28)+"px",T()),ye.style.display=0==de?"block":"none"}},!1),ye=document.createElement("div");var Et=ue?"left:"+(ie+ue-20+de)+"px":"left:"+(window.innerWidth-ne-20)+"px";ye.setAttribute("style","position:absolute; "+Et+"; top:"+(te-10)+"px; width:18px; height:9px; border:1px solid #aaa; background-color:rgba(192,192,255,0.7); cursor:ew-resize;"),ye.setAttribute("title","Drag to resize width"),he.appendChild(ye);var St=0,Mt=!1,Pt=!1,Ct=0;ye.addEventListener("click",a,!1),ye.addEventListener("mousedown",function(e){e.stopPropagation(),e.preventDefault(),Se.style.display="block",Mt=!0,Pt=!1,St=e.clientX},!1),document.addEventListener("mousemove",function(e){var t=e.clientX;if(!(t<=ie+200||t>=window.innerWidth-ne-20)&&(!Pt&&Mt&&Math.abs(t-St)>=4&&(Ct=Ze+=1,Qe.push([Ct,"resizing viewport"]),F(),Pt=!0,Mt=!1),Pt)){e.stopPropagation(),e.preventDefault();var n=t-St;0!=n&&(ue||(ue=window.innerWidth-ie-ne),St=t,ue+=n,O())}},!1),document.addEventListener("mouseup",function(e){if(Mt=!1,Se.style.display="none",Pt){c(Ct),Pt=!1,e.stopPropagation(),e.preventDefault();var t=e.clientX;if(t<=ie+200||t>=window.innerWidth-ne-20)return;var n=t-St;0!=n&&(ue||(ue=window.innerWidth-ie-ne),ue+=n,O())}},!1),window.addEventListener("resize",O,!1),(Ae=document.createElement("div")).setAttribute("style","position:relative; left:2%; top:0px; width:96%; height:60px; margin:4px 0px 0px 0px; line-height:1.1; font-size:13px; font-weight:300; background-color:#f4f4f4; overflow-y:auto; border-radius:3px;"),ge.appendChild(Ae),(Ee=document.createElement("div")).setAttribute("style","width:100%; height:"+Math.max(20,window.innerHeight-64)+"px;"),ge.appendChild(Ee),(Se=document.createElement("div")).setAttribute("style","display:none; position:absolute; left:0px; top:0px; width:100%; height:100%; z-index:3020;"),ge.appendChild(Se),Ae.addEventListener("click",function(e){var t=e.target;"BUTTON"==t.nodeName&&(e.stopPropagation(),t.style.color||Ee.showPage(t.getAttribute("name")))},!1),Ee.addPage=function(e,t,n){for(var i,o=0;i=Ee.children[o];o++)if(i.getAttribute("name")==e)return;var r=document.createElement("button");r.setAttribute("name",e),r.textContent=n||e,Ae.appendChild(r);var a=document.createElement("div");a.setAttribute("name",e),a.setAttribute("style","display:none; width:100%; height:100%;"),Ee.appendChild(a);var l=document.createElement("iframe");l.setAttribute("frameborder","no"),l.setAttribute("border","0"),l.setAttribute("style","border:0px solid #ccc; width:100%; height:100%;"),a.appendChild(l),l.setAttribute("src",t)},Ee.showPage=function(e){for(var t,n=0;t=Ee.children[n];n++)t.style.display=t.getAttribute("name")==e?"block":"none";for(var i,n=0;i=Ae.children[n];n++)i.style.color=i.getAttribute("name")==e?"#c00":""},Ee.rmvPage=function(e){for(var t,n="",i=0;t=Ee.children[i];i++)if(t.getAttribute("name")==e){"none"!=t.style.display&&(i<Ee.children.length-1?n=Ee.children[i+1].getAttribute("name"):i>0&&(n=Ee.children[i-1].getAttribute("name"))),Ee.removeChild(t);for(var o,r=0;o=Ae.children[r];r++)if(o.getAttribute("name")==e){Ae.removeChild(o);break}break}n&&Ee.showPage(n)},Ee.setPropEditor=function(e,t,n,i){var o=Ee.querySelector('div[name="property"] > iframe');if(o&&o.contentWindow){var r=e&&t&&n?{method:"init",param:[e,t,n,i]}:{method:"clear",param:[]},a="[PROJECT_NAME]"+JSON.stringify(r);o.contentWindow.postMessage(a,"*")}},Ee.showPropEditor=function(e){var t=Ee.querySelector('div[name="property"] > iframe');if(t&&t.contentWindow){var n={method:"setVisible",param:[!!e]},i="[PROJECT_NAME]"+JSON.stringify(n);t.contentWindow.postMessage(i,"*")}};for(var Lt,Nt=[],It=!1,Wt=!1,Ht=document.querySelectorAll("meta"),ft=0;Lt=Ht[ft];ft+=1)if("pinp:template"==Lt.getAttribute("property")){var _t=Lt.getAttribute("page"),Bt=Lt.getAttribute("content");"property"==_t?Bt||(It=!0):"resource"==_t?Bt||(Wt=!0):_t&&Bt&&Nt.push([_t,decodeURI(Bt)])}var zt=t("./").pathname;"/"!=zt[0]&&(zt="/"+zt);var Rt=rt.appBase()+"/list_resource.html?base="+encodeURIComponent(zt),jt="";It||(jt="property",Ee.addPage("property",rt.appBase()+"/prop_page.html"));var qt="";if(rt.useHtmlProxy&&(rt.repoName&&(qt+="&repo="+encodeURIComponent(rt.repoName)),rt.accessToken&&(qt+="&token="+encodeURIComponent(rt.accessToken)),rt.accessUser&&(qt+="&user="+encodeURIComponent(rt.accessUser)),rt.accessSite&&(qt+="&site="+encodeURIComponent(rt.accessSite))),!Wt){jt||(jt="resource");var Ut=Rt+"&home=1";rt.resourceBase&&(Ut+="&url="+encodeURIComponent(rt.resourceBase)),rt.useHtmlProxy&&(Ut+="&upload=1"+qt),Ee.addPage("resource",Ut)}Nt.forEach(function(e){jt||(jt=e[0]);var t=Rt+"&url="+encodeURIComponent(e[1]+"")+qt;Ee.addPage(e[0]+"",t)}),i("$utils?cmd=get_config",function(e,t){if(!e)try{var n=JSON.parse(t);"object"==typeof n&&(Je=n,(n.resourcePages||[]).forEach(function(e){jt||(jt=e[0]),Ee.addPage(e[0]+"",Rt+"&url="+encodeURIComponent(e[1]+"")+qt)}),Ee.children.length>=(n.lotResource||14)&&(Ae.style.height="96px",Ee.style.height=Math.max(20,window.innerHeight-100)+"px"))}catch(e){}jt&&Ee.showPage(jt)}),window.addEventListener("message",function(e){try{"object"==typeof e&&e.data?(e=e.data,e=JSON.parse(e.slice(14))):e=null}catch(t){e=null,console.log(t)}if("object"==typeof e)if("warning"==e.method)ce.instantShow(e.param[0]+"");else if("onDialogLoad"==e.method){var t=ze.querySelector("iframe");if(!t||t.messengerOK)return;t.messengerOK=!0,t.initDialog&&t.initDialog()}else if("onDialogExit"==e.method){var n=e.param[0],i=e.param[1];n&&(ze.innerHTML="",ce.setDialogModal(!1),ce.setDesignModal(!1)),i&&(y(),ce.saveDesigner&&ce.saveDesigner(n,e.param[2],e.param[3]))}else if("saveProp"==e.method)try{if(ce.updateWdgtProp){var r=Re,a=!1;r&&r.parentNode&&(Re=null,a=!0);var l=e.param[0],s=e.param[1];(e.param[2]||[]).forEach(function(e){s[e]=void 0}),y(),ce.updateWdgtProp(l,s,function(e,t){if(e){if(t&&t.classList.contains("rewgt-scene")){var n=d(t);F(),n&&setTimeout(function(){P(n,!1,function(){J(t,!1,!1)})},0)}else a&&t&&J(t,!1,!1);E(300,"")}else a&&(Re=r)})}}catch(e){console.log(e)}else if("dragEnd"==e.method){var p=e.param[0];"template"!=p&&"image"!=p||(W.selectedInfo=null,W.style.display="none")}else if("saveConfigData"==e.method){var n=e.param[0],i=e.param[1],u=e.param[2];n&&(ze.innerHTML="",ce.setDialogModal(!1),ce.setDesignModal(!1)),i&&"object"==typeof u&&o("$utils?cmd=save_config",u,function(e,t){e?(ce.instantShow("error: save configure failed"+(t?" ("+t+").":".")),console.log(e)):ce.instantShow("save configure successful.")})}else"closeDialog"==e.method&&(ze.innerHTML="",ce.setDialogModal(!1),ce.setDesignModal(!1))},!1),(Ce=document.createElement("div")).setAttribute("style","display:none; position:absolute; z-index:3010; pointer-events:none; border:1px dashed blue;"),document.body.appendChild(Ce),(_=document.createElement("div")).setAttribute("style","display:none; position:absolute; left:0px; top:0px; z-index:6000;"),document.body.appendChild(_),(Me=document.createElement("div")).setAttribute("style","display:none; position:absolute; z-index:3020; pointer-events:none; border:1px dotted red;"),document.body.appendChild(Me),document.body.appendChild(fe);Ht=[["Drag to move, double click to relay",rt.appBase()+"/res/move.png","move",!0],["Drag to insert, double click to relay",rt.appBase()+"/res/copy.png","copy",!0],["Drag to link, double click to relay",rt.appBase()+"/res/linker.png","linker",!0],["Modify child styles",rt.appBase()+"/res/styles.png","styles",!1],["Edit text content",rt.appBase()+"/res/edit_txt.png","edit_txt",!1],["Select uplevel",rt.appBase()+"/res/goup.png","uplevel",!1],["Copy as linker",rt.appBase()+"/res/copy2.png","copy_lnk",!1],["Pop to top",rt.appBase()+"/res/up.png","up",!1],["Push to bottom",rt.appBase()+"/res/down.png","down",!1]];(Te=document.createElement("div")).setAttribute("name","float-btn"),Te.setAttribute("style","position:absolute; visibility:hidden; padding:0 2px; line-height:15px; left:0px; top:-26px; width:"+(Ht.length*oe+2)+"px; height:22px; border:1px solid #ddd; background-color:#f0f0f0; overflow:hidden; pointer-events:auto;"),Me.appendChild(Te),Ht.forEach(function(e){var t=e[0],n=e[1],i=e[2],o=e[3],r=document.createElement("img");r.setAttribute("style","width:16px; height:16px; border:1px solid #f0f0f0; margin:2px;"),r.setAttribute("src",n),r.setAttribute("title",t),r.setAttribute("name",i),r.setAttribute("draggable",o?"true":"false"),Te.appendChild(r)}),Te.addEventListener("mousedown",function(e){e.stopPropagation(),"true"!=e.target.getAttribute("draggable")&&e.preventDefault()},!1),Te.addEventListener("mouseup",function(e){e.stopPropagation()},!1),Te.addEventListener("mouseover",function(e){var t=e.target;"IMG"==t.nodeName&&(t.style.borderColor="#fff #aaa #aaa #fff")},!1),Te.addEventListener("mouseout",function(e){var t=e.target;"IMG"==t.nodeName&&(t.style.borderColor="#f0f0f0")},!1),Te.addEventListener("click",function(e){function t(e){e&&E(1e3,o)}if(!s()){e.stopPropagation();var n=e.target,i="",o="",r=null;if("IMG"==n.nodeName){var a=n.getAttribute("name");if("up"!=a&&"down"!=a||!ce.setWdgtZIndex){if("uplevel"==a)b();else if("styles"==a&&ce.popDesigner){if(Re&&Re.parentNode&&(d=U(Re))){o=d[0],i=Ie.getAttribute("wdgt_name");l={name:"default",title:"styles editor",url:rt.appBase()+"/edit_styles.html",halfScreen:!1,clickable:!0,width:.8,height:.8,get:function(e){var t=e.props&&ce.widgetSchema(e,!1,!0);return t&&2==t.length?(r=t[1].wdgtOption||null,[r&&r.linkStyles||null,o,i]):[null,"",""]},set:function(e,t,n){function i(e,t){var n=o;if(a&&(Re=l),e){if(t){var i=U(t),r=i?i[0]:"";r&&r==o?J(t,!1,!1):n=""}E(300,n)}}var a=!1,l=Re,s=t[0],d=t[1];s&&r&&"object"==typeof d&&ce.saveCompStyles?(a=!0,Re=null,ce.saveCompStyles(e,r,d,i)):i(!1,null)}};ce.popDesigner(o,"default",l,"")}}else if("edit_txt"==a&&ce.popDesigner){if(Re&&Re.parentNode&&R(Re)&&(d=U(Re))){o=d[0],i=Ie.getAttribute("wdgt_name");var l={name:"default",title:"text editor",url:rt.appBase()+"/edit_content.html",halfScreen:!0,clickable:!0,width:.8,height:.8,get:function(e){return[e.textContent,o,i]},set:function(e,t,n){function i(e,t){var n=o;if(r&&(Re=a),e){if(t){var i=U(t),l=i?i[0]:"";l&&l==o?J(t,!1,!1):n=""}E(300,n)}}var r=!1,a=Re,l=t[0],s=t[1];l&&"string"==typeof s&&ce.saveNodeContent?(r=!0,Re=null,ce.saveNodeContent(o,s,i)):i(!1,null)}};ce.popDesigner(Re,"default",l,"")}}else if("copy_lnk"==a&&Re&&Re.parentNode){var d=U(Re);d&&($e=2,Ge.value='<div $="'+d[0]+'"></div>',Ge.select(),document.execCommand("copy"),setTimeout(function(){Te.style.visibility="hidden"},0))}}else{var p=null;if(Re&&Re.parentNode&&(d=U(Re))){var u=d[2];3==u.length&&"ScenePage"==u[1][0]&&(o=d[0],p=u[1][2][2])}if(!p)return;for(var c,f=[],h=0,g=0,v=null,m=null,x=0,w=0,k=0;c=p.children[k];k++){var A=parseInt(c.style.zIndex)||0;A>=1e3&&(A-=2e3),0==k?(h=A,v=c,g=A,m=c):(A>=h&&(v=c,A>(h=A)&&(x=0),x+=1),A<=g&&(m=c,A<(g=A)&&(w=0),w+=1)),f.push([A,c])}if(0==f.length)return;if("up"==a){if(Re===v&&1==x)return;y(),ce.setWdgtZIndex(o,Math.min(999,h+1),t)}else{if(Re===m&&1==w)return;y(),ce.setWdgtZIndex(o,Math.max(-999,g-1),t)}}}}},!1),Te.addEventListener("dblclick",function(e){if(!s()){var t=e.target;if("IMG"==t.nodeName&&"true"==t.getAttribute("draggable")){e.stopPropagation();var n=t.getAttribute("src"),i=t.getAttribute("name");n&&(Ne.setAttribute("src",n),i&&Ne.setAttribute("name",i),Ne.setAttribute("title",We.textContent),Ne.isSceneWdgt=We.isSceneWdgt,Ne.style.display="inline")}}},!1),Te.addEventListener("dragstart",function(e){if(!s()){var t=We.textContent,n=e.target;t&&"IMG"==n.nodeName&&"true"==n.getAttribute("draggable")&&(S=Ze+=1,Qe.push([S,"dragging widget"]),(I=n).isSceneWdgt=We.isSceneWdgt,e.dataTransfer.setData("text/plain",t))}},!1),Te.addEventListener("dragend",function(e){I&&c(S),I=null,W.selectedInfo=null,W.style.display="none"},!1),fe.addEventListener("click",function(e){e.stopPropagation(),Oe.hideMenu(),F()},!1),he.addEventListener("click",function(e){e.stopPropagation(),Oe.hideMenu(),F()},!1),setInterval(function(){if(!bt)try{Re&&Re.parentNode?H(Re,null):Re&&F()}catch(e){}},250),document.addEventListener("mousedown",$,!1),document.addEventListener("mousemove",V,!1),document.addEventListener("mouseup",Z,!1),(W=document.createElement("div")).setAttribute("style","display:none; position:absolute; z-index:3010; pointer-events:none; border:1px solid red;"),document.body.appendChild(W);var Xt=document.createElement("div");Xt.setAttribute("style","position:absolute; left:0px; top:-24px; width:100px; height:22px; color:#c00;"),W.appendChild(Xt),(D=document.createElement("img")).setAttribute("style","display:none; position:absolute; right:0px; bottom:0px; width:16px; height:16px;"),D.setAttribute("src",rt.appBase()+"/res/insert.png"),W.appendChild(D),et?g():setTimeout(function(){ce.instantShow("warning: undo/redo not supported, your browser has no local storage.")},0),(De=document.createElement("div")).setAttribute("style","display:none; position:absolute; left:0px; top:0px; z-index:3010; pointer-events:none;"),document.body.appendChild(De),(Oe=document.createElement("ul")).setAttribute("style","position:absolute; z-index:3022; display:none; left:30px; top:30px; min-width:60px; background-color:#f4f4f4; border:1px solid #eee; margin:0px; padding:2px; line-height:1.4; border-radius:4px; box-shadow:-2px 4px 4px rgba(0,0,0,0.2); list-style:none; -webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none"),Oe.innerHTML='<li name="list_prj" style="padding:0px 8px">List projects</li><li name="show_doc" style="padding:0px 8px">Online document</li>',document.body.appendChild(Oe),rt.useHtmlProxy&&(Oe.querySelector('li[name="list_prj"]').style.display="none"),Oe.addEventListener("mouseover",function(e){var t=e.target;"LI"==t.nodeName&&(t.style.backgroundColor="blue",t.style.color="white")},!1),Oe.addEventListener("mouseout",function(e){var t=e.target;"LI"==t.nodeName&&(t.style.backgroundColor="",t.style.color="")},!1),Oe.addEventListener("click",function(e){e.stopPropagation(),Oe.style.display="none";var t=e.target;if("LI"==t.nodeName){var n=t.getAttribute("name");if("list_prj"==n)i("$utils?cmd=list_project",function(e,t){if(e)ce.instantShow("warning: query project failed.");else try{var n,i,o=JSON.parse(t);if(Array.isArray(o)&&2==o.length&&Array.isArray(n=o[0])&&Array.isArray(i=o[1])){var r=n.length,a=n.concat(i),l={name:"default",title:"list project",url:rt.appBase()+"/list_projects.html",halfScreen:!0,width:.9,height:.9,clickable:!1};ce.showDesignDlg(0,l,a,"",r)}}catch(e){}});else if("show_doc"==n){var o={name:"default",title:"online help",url:rt.appBase()+"/doc/index.html",halfScreen:!1,width:.9,height:.9,clickable:!1};ce.showDesignDlg(0,o,{},"")}}},!1),Oe.showMenu=function(e,t){Oe.style.left=e+"px",Oe.style.top=t+"px",Oe.style.display="block"},Oe.hideMenu=function(){Oe.style.display="none"},(He=document.createElement("div")).setAttribute("style","position:absolute; z-index:3020; display:none; left:0px; top:0px; width:100%; height:100%"),he.appendChild(He),(_e=document.createElement("div")).setAttribute("style","position:absolute; z-index:3020; display:none; left:0px; top:0px; width:100%; height:100%"),fe.appendChild(_e),(Be=document.createElement("div")).setAttribute("style","position:absolute; z-index:3020; display:none; left:0px; top:0px; width:100%; height:100%"),ge.appendChild(Be),(ze=document.createElement("div")).isFull=!0,ze.setAttribute("style","position:absolute; z-index:3020; display:none; left:"+ie+"px; top:0px; width:"+(window.innerWidth-ie)+"px; height:100%; overflow:hidden"),document.body.appendChild(ze);var Jt=!1,Ft=!1,Kt=null,Gt=null,$t=0,Yt=0;ze.onmouseup=Be.onmouseup=_e.onmouseup=He.onmouseup=function(e){Ft||e.stopPropagation()},ze.addEventListener("mousemove",function(e){if(e.stopPropagation(),Jt&&Kt&&Kt.parentNode&&Gt&&Gt.parentNode){var t=e.clientX-$t,n=e.clientY-Yt;Ft||(Math.abs(t)>=4||Math.abs(n>=4))&&(Ft=!0),!Ft||0==t&&0==n||(Kt.style.left=Kt.offsetLeft+t+"px",Kt.style.top=Kt.offsetTop+n+"px",Gt.style.left=Gt.offsetLeft+t+"px",Gt.style.top=Gt.offsetTop+n+"px",$t+=t,Yt+=n)}},!1),document.addEventListener("mouseup",function(e){Jt=!1,Ft=!1,Kt&&Kt.parentNode&&(Kt.style.width="10px",Kt.style.height="10px")},!1),ze.ondblclick=Be.ondblclick=_e.ondblclick=He.ondblclick=l,ze.onmousedown=Be.onmousedown=_e.onmousedown=He.onmousedown=l,ze.onmousemove=Be.onmousemove=_e.onmousemove=He.onmousemove=a,ze.onkeypress=Be.onkeypress=_e.onkeypress=He.onkeypress=l,ze.onkeydown=Be.onkeydown=_e.onkeydown=He.onkeydown=l,ze.onkeyup=Be.onkeyup=_e.onkeyup=He.onkeyup=a,ze.ondragover=Be.ondragover=_e.ondragover=He.ondragover=a,ze.ondrop=Be.ondrop=_e.ondrop=He.ondrop=a,ce.selectedWidget=function(e){var t=Re;return e&&"string"==typeof e.nodeName&&(Re=e),t&&t.parentNode?t:null},ce.notifyBackup=function(e,t){E(t||300,e)},ce.showDesignDlg=function(e,t,n,i,o){var r=window.innerWidth-ie,a=window.innerHeight;t.halfScreen?(r-=ce.frameInfo.rightWd,ze.isFull=!1,Ee.showPropEditor(!1)):ze.isFull=!0,ze.style.width=r+"px",ze.innerHTML="";var l,s=t.url+"";l="/"==s[0]||0==s.indexOf("http")&&(":"==s[4]||"s:"==s.slice(4,6))?s:(i=i||"")&&"/"!=i.slice(-1)?i+"/"+s:i+s;var d,p=parseFloat(t.left),u=parseFloat(t.top),c=parseFloat(t.width);"number"!=typeof c||c>=.9999&&c<1||c<=0?(c="100%",d=0):c>=1?(d=Math.floor((r-c)/2),c+="px"):(d=Math.floor((1-c)/2*r),"number"==typeof p&&p>0&&p<1&&p<1-c&&(d=Math.floor(p*r)),c=100*c+"%");var f,h=parseFloat(t.height);"number"!=typeof h||h>=.9999&&h<1||h<=0?(h="100%",f=0):h>=1?(f=Math.floor((a-h)/2),h+="px"):(f=Math.floor((1-h)/2*a),"number"==typeof u&&u>0&&u<1&&u<1-h&&(f=Math.floor(u*a)),h=100*h+"%"),(Gt=document.createElement("iframe")).setAttribute("frameborder","no"),Gt.setAttribute("border","0"),Gt.setAttribute("style","position:absolute; border:0px solid #e0e0e0; left:0px; top:0px; width:100%; height:100%;"),Gt.style.left=d+"px",Gt.style.top=f+"px",Gt.style.width=c,Gt.style.height=h;var g=!0;"100%"!=c&&"100%"!=h&&(g=!1,Gt.style.borderWidth="1px",Gt.style.boxShadow="-2px 8px 4px rgba(0,0,0,0.1)"),Gt.messengerOK=!1,Gt.initDialog=function(){if(Gt.messengerOK&&ce.pluginCss)try{var t=[e,n,ce.pluginCss()];void 0!==o&&t.push(o);var i="[PROJECT_NAME]"+JSON.stringify({method:"init",param:t});Gt.contentWindow.postMessage(i,"*")}catch(e){console.log(e)}},Gt.exitDialog=function(){if(Gt.messengerOK){var e="[PROJECT_NAME]"+JSON.stringify({method:"close",param:[!0]});Gt.contentWindow.postMessage(e,"*")}else setTimeout(function(){ze.innerHTML="",ce.setDialogModal(!1),ce.setDesignModal(!1)},0)},ze.appendChild(Gt);var v=rt.useHtmlProxy?"$proxy.html":"$proxy";if(Gt.setAttribute("src",v+"?url="+encodeURIComponent(l)),!g&&!t.noMove){(Kt=document.createElement("div")).setAttribute("style","position:absolute; left:"+d+"px; top:"+f+"px; width:10px; height:10px;");var m=document.createElement("div");m.setAttribute("style","width:10px; height:10px; background-color:#00d; cursor:move;"),Kt.appendChild(m),ze.appendChild(Kt),m.onmousedown=function(e){e.stopPropagation(),e.preventDefault(),Kt&&Kt.parentNode&&(Jt=!0,Ft=!1,Kt.style.width="100%",Kt.style.height="100%",$t=e.clientX,Yt=e.clientY)}}ce.setDialogModal(!0)},ce.setDesignModal=function(e){e||ce.closeModal(),ce.style.zIndex=e?"3012":"3000";var t=e?"block":"none";He.style.display=t,_e.style.display=t,Be.style.display=t,e||Ee.showPropEditor(!0)},ce.setDialogModal=function(e){var t=e?"block":"none";e||(He.style.display="none",Be.style.display="none",ce.style.zIndex="3000"),_e.style.display=t,ze.style.display=t},ze.onclick=Be.onclick=_e.onclick=He.onclick=function(e){e.stopPropagation(),Oe.hideMenu();var t=e.target;setTimeout(function(){var e=!1,n=null,i=!0;if(t===_e||t===ze)"none"!=ze.style.display&&(n=ze.querySelector("iframe"))&&n.exitDialog&&(e=!0),e||ce.setDialogModal(!1);else for(var o=t.parentNode;o;){if(o===_e||o===ze){i=!1;break}if(o===document)break;o=o.parentNode}e?n.exitDialog():i&&ce.setDesignModal(!1)},300)};var Vt=!0;ce.addEventListener("click",function(e){function t(){if(Vt){var e=m[0],t=m[1],n=m[2];H(t,n),he.setWidgetInfo(n),he.listChildren(e),W.style.display="none"}}if(!s()&&!(yt||xt||Tt||Dt||Ot||ce.splitterMouseDn&&ce.splitterMouseDn())){Oe.hideMenu();var n=e.target;if("SELECT"!=n.nodeName)if(e.shiftKey){var i=null,o="";if("ScenePage"==Fe&&Ke){for(;n&&n!==ce;){var r=n.parentNode;if(r&&r.classList.contains("rewgt-center")){var a=r.parentNode;if(a&&a.classList.contains("rewgt-scene")){i=n;break}}n=r}i&&(o=d(i))}if(o){var l=!1;if("block"==De.style.display&&De.children.length>=1){for(var p=!1,u=1;h=De.children[u];u+=1)if(o===h.getAttribute("keyid")){De.removeChild(h),p=!0;break}if(p)De.children.length<=1?De.style.display="none":l=!0;else{c=i.getBoundingClientRect();(f=document.createElement("div")).setAttribute("keyid",o),f.setAttribute("style","position:absolute; border:1px dotted red; left:"+c.left+"px; top:"+c.top+"px; width:"+Math.max(0,c.width-2)+"px; height:"+Math.max(0,c.height-2)+"px;"),De.appendChild(f),l=!0}}else if(!Re||Re.classList.contains("rewgt-scene")){var c=i.getBoundingClientRect(),f=document.createElement("div");f.setAttribute("keyid",o),f.setAttribute("style","position:absolute; border:1px dotted red; left:"+c.left+"px; top:"+c.top+"px; width:"+Math.max(0,c.width-2)+"px; height:"+Math.max(0,c.height-2)+"px;"),De.appendChild(f),De.style.display="block",l=!0}if(l){je+=1;for(var h,g=[Ke],u=1;h=De.children[u];u+=1)(o=h.getAttribute("keyid"))&&g.push(o);g.length>1&&G(g)}}}else{var v=!1;if(Re&&Re.parentNode)for(;n&&n!==ce;){if(n===Re){v=!0;break}n=n.parentNode}De.style.display="none";var m=U(e.target);m&&(Vt=!0,v?setTimeout(function(){t()},300):t())}}},!1),ce.addEventListener("dblclick",function(e){if(!s()&&!yt&&!xt&&Re&&Re.parentNode&&ce.popDesigner){for(var t=e.target,n=!1;t&&t!==ce;){if(t===Re){n=!0;break}t=t.parentNode}if(n){var i=U(Re);if(i){Vt=!1;var o=i[0],r=i[2],a=Re.getAttribute("data-group.optid"),l=B(r),d=0!=l||B(r,!0)>0;if(l<=1&&a&&a.indexOf("/")>0){var p=ot[a];if(Array.isArray(p)){var u=p[2];if((p=p[1])&&(u&&ce.getGroupOpt&&(p=z(p,o)),f=p.find(function(e){return"default"===e.name}))){var c=Object.assign({},f);if(!c.get||!c.set){h=N(o,d);c.get=h[0],c.set=h[1]}return void ce.popDesigner(o,"default",c,c.baseUrl||"")}}}if(l<=1&&ce.popDesigner(o,"default"))return;if(l>=2)return;var f={name:"default",title:"default editor",url:rt.appBase()+"/edit_prop.html",halfScreen:!0,clickable:!1,width:.9,height:.9},h=N(o,d);f.get=h[0],f.set=h[1],ce.popDesigner(o,"default",f,"")}}}},!1),ce.addEventListener("dragover",function(t){if(!s()){var n,i=!!t.shiftKey,o=!1,a=!1;if(r(t.dataTransfer,"application/json"))n=!1,o=!0;else{if(!I)return;if(I!==Ne&&I.parentNode!==Te)return;a="linker"==I.getAttribute("name"),n=I.isSceneWdgt}var l=[],d=U(t.target,l);if(d){var p=d[0],u=d[1],c=d[2],f=p.split(".").pop(),h=c.length>=2&&"ScenePage"==c[1][0],g=!1;if(h&&n&&!i){var v=c[1][2];if(p=v[1],a){if(!(l.length>=3))return;u=l[2],p=p+"."+(f=(c=c.slice(0,3))[2][1])}else l.length>=3?g=!0:(u=v[2],f=(c=c.slice(0,2))[1][1])}else h&&o&&!a&&l.length>=3&&(g=!0);if(g)for(var m=l.length-1;m>=2;){if(!(u=l[m]).getAttribute("data-is.ground")){for(f=(c=c.slice(0,m+1))[m][1],m-=1,p=f;m>=0;)p=c[m][1]+"."+p,m-=1;break}m-=1}var y=h&&3==c.length,b=h&&2==c.length,x=!1,w=u.getBoundingClientRect(),k=Math.min(0,w.top-te);k<0&&(x=!0,w={left:w.left,top:te,width:w.width,height:w.height+k}),W.selectedInfo=[p,u,c],W.style.left=w.left+"px",W.style.top=w.top+"px",W.style.width=Math.max(0,w.width-2)+"px",W.style.height=Math.max(0,w.height-2)+"px",W.style.borderColor=x?y?"transparent blue blue blue":"transparent red red red":y?"blue":"red",W.style.display="block",Xt.innerHTML=e(f||""),!a&&w.width>=20&&w.height>=10&&!b?D.style.display="block":D.style.display="none",t.preventDefault()}else W.style.display="none",o&&t.preventDefault()}},!1),ce.addEventListener("drop",function(e){e.stopPropagation(),e.preventDefault();var t=!!e.shiftKey,n=e.clientX,i=e.clientY;if(!t&&"none"!=D.style.display){var o=D.getBoundingClientRect();n>=o.left&&n<o.left+o.width&&i>=o.top&&i<o.top+o.height&&(t=!0)}if(n=n-ie-de-ae,i=i-te-pe-le,r(e.dataTransfer,"application/json")){var a=null,l=e.dataTransfer.getData("application/json")||"{}";try{a=JSON.parse(l)}catch(e){console.log(e)}if(!a||"template"!=a.dragType&&"image"!=a.dragType)return;var s=(w="none"!=W.style.display&&W.selectedInfo)?w[0]:null;if("image"==a.dragType){var d=a.dragUrl,p=a.clientWidth,u=a.clientHeight;if(!d)return;0==d.indexOf(se)&&d.length>se.length&&(d=d.slice(se.length));v=!1;"ScenePage"==Fe&&Ke&&((!s||s.split(".").length<=3)&&(s=ce.frameInfo.rootName+"."+Ke,t=!0),(3==(m=s.split(".")).length||!t&&4==m.length)&&(v=!0));var c={src:d},g=["Img",c,3];p&&u&&(c.style={width:p+"px",height:u+"px"}),v&&(g=[["P",{klass:"default-large-small hidden-visible-auto","data-group.optid":"rewgt/shadow-slide/steps"},2],g]),h(v,s,{option:{name:"Img",widget:g}},t,n,i)}else{var v=!1;if("ScenePage"==Fe&&Ke&&s){var m=s.split(".");(3==m.length||!t&&4==m.length)&&(v=!0)}h(v,s,a,t,n,i)}}else if(I){var b=I.getAttribute("name"),x=e.dataTransfer.getData("text/plain"),w=W.selectedInfo;if(b&&x&&w){var k=w[0];w[1],w[2];"linker"==b&&ce.bindLinker?(y(),ce.bindLinker(x,k,function(e){e&&(Ne.style.display="none",E(300,""))})):"copy"!=b&&"move"!=b||f(x,k,t,"move"==b,n,i,function(e){e&&(Ne.style.display="none")})}}},!1),q.querySelector('img[name="menu"]').onclick=function(e){e.stopPropagation(),Oe.showMenu(e.clientX,e.clientY)},at=function(){"none"==ke.style.display?(gt&&(gt=!1,0==ke.children.length&&ce.topmostNode&&ce.topmostNode()&&F()),be.style.visibility="visible",ke.style.display="block"):(ke.style.display="none",be.style.visibility="hidden")},q.querySelector('img[name="thumb"]').onclick=function(e){e.stopPropagation(),Oe.hideMenu(),at()},X.querySelector('img[name="switch"]').onclick=function(e){e.stopPropagation(),Oe.hideMenu(),ce.frameInfo.topHi?(ce.frameInfo.topHi=0,ce.frameInfo.rightWd=0,fe.style.backgroundPosition=ie-14+"px "+pe+"px",he.style.display="none",ge.style.display="none"):(ce.frameInfo.topHi=te,ce.frameInfo.rightWd=ne,fe.style.backgroundPosition=ie-14+"px "+(te+pe)+"px",he.style.display="block",ge.style.display="block"),O()},X.querySelector('img[name="align"]').onclick=function(e){e.stopPropagation(),Oe.hideMenu(),0==de&&0==pe||(de=0,pe=0,ye.style.display="block",ce.style.left=de+"px",ce.style.top=pe+"px",fe.style.backgroundPosition=ie-14+"px "+((0==ce.frameInfo.topHi?0:te)+pe)+"px",he.style.backgroundPosition=ie+de+"px "+(te-28)+"px",T(),ce.frameInfo.bottomHi=pe,ce.refreshFrame&&ce.refreshFrame())},X.querySelector('img[name="delete"]').onmousedown=function(e){e.stopPropagation(),e.preventDefault(),Oe.hideMenu(),x(!0)},X.querySelector('img[name="undo"]').onclick=function(e){e.stopPropagation(),Oe.hideMenu(),w()},X.querySelector('img[name="redo"]').onclick=function(e){e.stopPropagation(),Oe.hideMenu(),k()},X.querySelector('img[name="save"]').onclick=A,X.querySelector('img[name="open"]').onclick=function(e){e.stopPropagation(),Oe.hideMenu(),i("$utils?cmd=list_page",function(e,n){if(e)ce.instantShow("warning: query HTML file list failed.");else try{var i=JSON.parse(n);if(Array.isArray(i)){var o={name:"default",title:"open pages",url:rt.appBase()+"/list_pages.html",halfScreen:!0,width:.9,height:.9,clickable:!1},r=t("./").href;ce.showDesignDlg(0,o,{currProj:r,currFile:Xe,pages:i},"")}}catch(e){}})},X.querySelector('img[name="config"]').onclick=function(e){e.stopPropagation(),Oe.hideMenu();var t={name:"default",title:"edit configure",url:rt.appBase()+"/edit_config.html",halfScreen:!1,width:.8,height:.9,clickable:!1};ce.showDesignDlg(0,t,Je,"")};var Zt=null,Qt="";(Ge=document.createElement("textarea")).setAttribute("style","position:absolute; left:0px; top:0px; width:24px; height:24px; overflow:hidden"),document.body.appendChild(Ge),Ge.addEventListener("copy",function(e){Zt=null;var t=2==$e&&Ge.value;t&&Ve==je?setTimeout(function(){ce.instantShow("copy successful, wait to paste...")},0):(e.preventDefault(),t&&Ve!=je&&ce.instantShow("copy selected widget failed."))},!1),Ge.addEventListener("paste",function(e){var t=Zt;Zt=null,e.preventDefault();for(var n,i=e.clipboardData.types,o="",r=0;n=i[r];r+=1)if("Text"==n||0==n.indexOf("text/")){o=e.clipboardData.getData(n);break}var a="";if(o)if(!Re&&"ScenePage"==Fe&&Ke)a=ce.frameInfo.rootName+"."+Ke;else if(o&&Re&&Re.parentNode){var l=U(Re);l&&(a=l[0])}a&&ce.pasteWidget&&(t&&(o!==Qt&&(t=null),Qt=""),y(),ce.pasteWidget(a,o,t,function(e,t,n){e&&(ce.instantShow(e+" widget(s) pasted."),t&&F(),n&&setTimeout(function(){J(n,!1,!1)},300),E(300,""))}))},!1),Ge.addEventListener("cut",function(e){var t=2==$e&&Ge.value;if(Ve!=je)return e.preventDefault(),void(t&&ce.instantShow("cut selected widget failed."));if(t&&"string"==typeof Ye){var n=U(Ye);if(n&&B(n[2])>=1)return e.preventDefault(),void ce.instantShow("cut selected widget disallowed.")}t&&(Zt=Ye,Qt=Ge.value,setTimeout(function(){ce.instantShow("cut successful, wait to paste...")},0))},!1),Ge.addEventListener("keydown",function(e){var t=e.keyCode;if(!e.ctrlKey&&!e.metaKey||67!=t&&86!=t&&88!=t){if(83==t&&(e.ctrlKey||e.metaKey))return e.preventDefault(),void A(e);if(e.preventDefault(),e.shiftKey){if(37==t)b();else if(39==t){if(Re&&Re.parentNode&&ce.firstChildOf&&(i=U(Re))){var n=ce.firstChildOf(i[0],!0);n&&J(n,!1,!1)}}else if(38==t||40==t){var i;if(Re&&Re.parentNode&&"ScenePage"==Fe&&Ke&&ce.listPageChild&&(i=U(Re))){var o=i[2],r=o.length>=3?o[2][1]:"";if((i=ce.listPageChild(Ke)).length){bSort=[],i.forEach(function(e){var t=e[1],n=t.getBoundingClientRect();0==n.width&&0==n.height||bSort.push([n.top,n.left,e[0],t])}),bSort.sort(function(e,t){return e[0]==t[0]?e[1]-t[1]:e[0]-t[0]});var a=null;if(r)for(var l,s=0;l=bSort[s];s+=1)if(l[2]==r){a=38==t?s>0?bSort[s-1][3]:l[3]:s<bSort.length-1?bSort[s+1][3]:l[3];break}a||(a=38==t?bSort[0][3]:bSort[bSort.length-1][3]),J(a,!1,!1)}}}}else if(e.altKey)if(8==t)x(!1);else{var d=0,p=0;if(37==t?d=-1:38==t?p=-1:39==t?d=1:40==t&&(p=1),(d||p)&&"ScenePage"==Fe&&Ke)if("block"==De.style.display&&De.children.length>1)Y(Ke,d,p);else if(Re&&Re.parentNode&&(i=U(Re))){var u=i[0];y(),1==(i=ce.moveSceneWdgt(u,d,p)).length&&(d&&(Me.style.left=parseFloat(Me.style.left)+d+"px"),p&&(Me.style.top=parseFloat(Me.style.top)+p+"px"),E(3e3,u))}}}},!1)}}}var ee="0.0.2",te=116,ne=220,ie=40,oe=22,re=136,ae=450,le=350,se="",de=0,pe=0,ue=0,ce=null,fe=null,he=null,ge=null,ve=null,me=null,ye=null,be=null,xe=null,we=null,ke=null,Ae=null,Ee=null,Se=null,Me=null,Pe={left:0,top:0,width:0,height:0},Ce=null,Le={left:0,top:0,width:0,height:0},Te=null,Ne=null,Ie=null,We=null,De=null,Oe=null,He=null,_e=null,Be=null,ze=null,Re=null,je=0,qe=!1,Ue=!1,Xe="",Je={},Fe="",Ke="",Ge=null,$e=0,Ye=null,Ve=0,Ze=0,Qe=[],et=!!window.localStorage,tt=(new Date).valueOf()-1e3,nt=0,it=0,ot={},rt=null,at=null,lt=function(e){return""},st=!1,dt=0,pt=0,ut=0,ct=0,ft=[],ht=[],gt=[],vt=0,mt=0,yt=0,bt=!1,xt=!1,wt=!1,kt=0,At=0,Et=0,St="",Mt=!1,Pt=0,Ct=0,Lt=!1,Tt=!1,Nt=0,It=0,Wt=!1,Dt=!1,Ot=!1,Ht=!1,_t=0,Bt=0,zt=0;setTimeout(function(){function e(n){n&&((t+=1)>180?setTimeout(function(){n(!1)},0):setTimeout(function(){window.W&&W.$main&&W.$main.inRunning?n(!0):e(n)},500))}var t=0;e(function(e){function t(e){P(e,!1),setTimeout(function(){at()},2e3)}if(e&&"object"==typeof W&&W.$creator){var n=document.createElement("style");if(n.innerHTML="@-moz-document url-prefix(){button{padding:0px;}}",document.head.appendChild(n),rt=W.$creator,Q(),W.$main&&(W.$main.inDesign=!0,ce.keyOfNode&&(lt=ce.keyOfNode)),ce.onlyScenePage&&ce.onlyScenePage()){var i=ce.topmostNode();if(!i)return;for(var o,r=0;o=i.children[r];r++)if(o.classList.contains("rewgt-scene")){var a=d(o);return void(a&&setTimeout(function(){t(a)},800))}}}else alert("load shadow-widget system failed!")})},800)}();